<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title>sorl.thumbnail</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 5196 2007-06-03 20:25:28Z wiemann $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="sorl-thumbnail">
<h1 class="title">sorl.thumbnail</h1>

<p>The <tt class="docutils literal"><span class="pre">sorl.thumbnail</span></tt> package provides an easy way to generate image
thumbnails by using either the <a class="reference internal" href="#thumbnail-template-tag">{% thumbnail %} template tag</a> or the
<a class="reference internal" href="#imagewiththumbnailsfield">ImageWithThumbnailsField</a>.
or the</p>
<p>It requires the Python Imaging Library (<a class="reference external" href="http://www.pythonware.com/products/pil/">PIL</a>).</p>
<p>To enable PDF thumbnails you need <a class="reference external" href="http://www.imagemagick.org/">ImageMagick</a> and to enable Word document
thumbnails you need both <a class="reference external" href="http://wvware.sourceforge.net/">wvWare</a> and <a class="reference external" href="http://www.imagemagick.org/">ImageMagick</a>.</p>
<div class="section" id="thumbnail-template-tag">
<h1>{% thumbnail %} template tag</h1>
<p>To use this tag, add <tt class="docutils literal"><span class="pre">'sorl.thumbnail'</span></tt> to your <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt> setting.
Once you've done that, use <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">load</span> <span class="pre">thumbnail</span> <span class="pre">%}</span></tt> in a template to give your
template access to the tag.</p>
<div class="section" id="basic-usage">
<h2>Basic usage</h2>
<p>The thumbnail tag creates a thumbnail if it doesn't exist or if the source
was modified more recently than the existing thumbnail. The resulting
thumbnail object contains the generated thumbnail image along with some other
potentially useful data. Syntax:</p>
<pre class="literal-block">
{% thumbnail [source] [size] [options] %}
</pre>
<p><tt class="docutils literal"><span class="pre">source</span></tt> must an object where force_unicode(object) returns a path to a file
relative to <tt class="docutils literal"><span class="pre">MEDIA_ROOT</span></tt>. This means an Image/FileField or string/unicode
object containing the relative path to a file.</p>
<p><tt class="docutils literal"><span class="pre">size</span></tt> can either be:</p>
<blockquote>
<ul class="simple">
<li>the size in the format <tt class="docutils literal"><span class="pre">[width]x[height]</span></tt> (for example,
<tt class="docutils literal"><span class="pre">{%</span> <span class="pre">thumbnail</span> <span class="pre">source</span> <span class="pre">100x50</span> <span class="pre">%}</span></tt>) or</li>
<li>a variable containing a valid size (i.e. either a string in the
<tt class="docutils literal"><span class="pre">[width]x[height]</span></tt> format or a tuple containing two integers):
<tt class="docutils literal"><span class="pre">{%</span> <span class="pre">thumbnail</span> <span class="pre">source</span> <span class="pre">size_string</span> <span class="pre">%}</span></tt>.</li>
</ul>
</blockquote>
<p><tt class="docutils literal"><span class="pre">options</span></tt> are optional (obviously) and should be comma separated (without a
space between them - for example, <tt class="docutils literal"><span class="pre">crop,bw,quality=95</span></tt>). Unless you change
the <a class="reference internal" href="#thumbnail-processors">thumbnail processors</a>, valid options are:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">quality=[1-100]</span></tt></dt>
<dd>Alter the quality of the JPEG thumbnail (the default is 85).</dd>
<dt><tt class="docutils literal"><span class="pre">crop</span></tt></dt>
<dd>Crop the source image height or width to exactly match the requested
thumbnail size (the default is to proportionally resize the source image
to fit within the requested thumbnail size).</dd>
<dt><tt class="docutils literal"><span class="pre">autocrop</span></tt></dt>
<dd>Remove any unnecessary whitespace from the edges of the source image.
This occurs before the crop or propotional resize.</dd>
<dt><tt class="docutils literal"><span class="pre">bw</span></tt></dt>
<dd>Make the thumbnail grayscale (not really just black &amp; white).</dd>
<dt><tt class="docutils literal"><span class="pre">upscale</span></tt></dt>
<dd>Allow upscaling of the source image during scaling.</dd>
<dt><tt class="docutils literal"><span class="pre">sharpen</span></tt></dt>
<dd>Sharpen the thumbnail image (using the PIL sharpen filter)</dd>
<dt><tt class="docutils literal"><span class="pre">detail</span></tt></dt>
<dd>Add detail to the image, like a mild <tt class="docutils literal"><span class="pre">sharpen</span></tt> (using the PIL detail
filter)</dd>
</dl>
<p>An example of basic usage:</p>
<pre class="literal-block">
&lt;img src=&quot;{% thumbnail person.photo 80x80 crop,upscale %}&quot; /&gt;
</pre>
</div>
<div class="section" id="advanced-usage">
<h2>Advanced usage</h2>
<p>The thumbnail tag can also place a <tt class="docutils literal"><span class="pre">DjangoThumbnail</span></tt> object on the context,
providing access to the properties of the thumbnail such as the height and
width:</p>
<pre class="literal-block">
{% thumbnail [source] [size] [options] as [variable] %}
</pre>
<p>When <tt class="docutils literal"><span class="pre">as</span> <span class="pre">[variable]</span></tt> is used, the tag does not return the absolute url of the
thumbnail. The variable (containing the <tt class="docutils literal"><span class="pre">DjangoThumbnail</span></tt> object) has the
following useful methods and properties:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">absolute_url</span></tt></dt>
<dd>The absolute url of the thumbnail (the <tt class="docutils literal"><span class="pre">__unicode__</span></tt> method of this
object also returns the absolute url, so you can also just do
<tt class="docutils literal"><span class="pre">{{</span> <span class="pre">thumbnail_variable</span> <span class="pre">}}</span></tt>).</dd>
<dt><tt class="docutils literal"><span class="pre">relative_url</span></tt></dt>
<dd>The relative url (to MEDIA_URL) of the thumbnail.</dd>
<dt><tt class="docutils literal"><span class="pre">width</span></tt> and <tt class="docutils literal"><span class="pre">height</span></tt></dt>
<dd>The width/height of the thumbnail image.</dd>
<dt><tt class="docutils literal"><span class="pre">filesize</span></tt></dt>
<dd>The file size (in bytes) of the thumbnail.
To output user-friendly file sizes, use the included <a class="reference internal" href="#filesize-filter">filesize filter</a>
(or Django's built-in more simplistic <tt class="docutils literal"><span class="pre">filesizeformat</span></tt> filter).</dd>
<dt><tt class="docutils literal"><span class="pre">source_width</span></tt> and <tt class="docutils literal"><span class="pre">source_height</span></tt></dt>
<dd>The width/height of the source image.</dd>
<dt><tt class="docutils literal"><span class="pre">source_filesize</span></tt></dt>
<dd>The file size of the source. Has same methods as <tt class="docutils literal"><span class="pre">filesize</span></tt>.</dd>
</dl>
<p>An example of advanced usage:</p>
<pre class="literal-block">
{% thumbnail person.photo 250x250 bw,autocrop as thumb %}
&lt;img src=&quot;{{ thumb }}&quot; width=&quot;{{ thumb.width }}&quot; height=&quot;{{ thumb.height }}&quot; /&gt;
</pre>
</div>
<div class="section" id="debugging-the-thumbnail-tag">
<h2>Debugging the thumbnail tag</h2>
<p>By default, if there is an error creating the thumbnail or resolving the image
variable (1st argument) then the thumbnail tag will just return an empty string.
And if there was a context variable to be set it will also be set to an empty
string.</p>
<p>For example, you will not see an error if the thumbnail could not be written
to directory because of permissions error.</p>
<p>To display those errors rather than failing silently, add a <tt class="docutils literal"><span class="pre">THUMBNAIL_DEBUG</span></tt>
property to your settings module and set it to <tt class="docutils literal"><span class="pre">True</span></tt>:</p>
<pre class="literal-block">
THUMBNAIL_DEBUG = True
</pre>
</div>
</div>
<div class="section" id="imagewiththumbnailsfield">
<h1>ImageWithThumbnailsField</h1>
<p><tt class="docutils literal"><span class="pre">ImageWithThumbnailsField</span></tt> (which you import from <tt class="docutils literal"><span class="pre">sorl.thumbnail.fields</span></tt>)
works very similar to Django's <tt class="docutils literal"><span class="pre">ImageField</span></tt>.</p>
<p>A new <tt class="docutils literal"><span class="pre">thumbnail</span></tt> argument is required for this field. Pass in a dictionary
with the following values (all optional except for <tt class="docutils literal"><span class="pre">size</span></tt>):</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">size</span></tt> (required)</dt>
<dd>A 2-length tuple of the thumbnail width and height.</dd>
<dt><tt class="docutils literal"><span class="pre">options</span></tt></dt>
<dd>A list of options for this thumbnail.</dd>
<dt><tt class="docutils literal"><span class="pre">quality</span></tt>, <tt class="docutils literal"><span class="pre">basedir</span></tt>, <tt class="docutils literal"><span class="pre">subdir</span></tt> and <tt class="docutils literal"><span class="pre">prefix</span></tt></dt>
<dd>See the options of the template tag (above) for details.</dd>
</dl>
<p>Your model instance's field will have two new properties:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">thumbnail</span></tt></dt>
<dd>Returns a <tt class="docutils literal"><span class="pre">DjangoThumbnail</span></tt> instance for your pleasure (if you use this in
a template, it'll return the full URL to the thumbnail).</dd>
<dt><tt class="docutils literal"><span class="pre">thumbnail_tag</span></tt></dt>
<dd>Returns an HTML like <tt class="docutils literal"><span class="pre">&lt;img</span> <span class="pre">src=&quot;...&quot;</span> <span class="pre">width=&quot;...&quot;</span> <span class="pre">height=&quot;...&quot;</span> <span class="pre">alt=&quot;&quot;</span> <span class="pre">/&gt;</span></tt>.</dd>
</dl>
<p>Let's look at an example. Here is a model with an <tt class="docutils literal"><span class="pre">ImageWithThumbnailsField</span></tt>:</p>
<pre class="literal-block">
MyModel(models.Model):
    name = models.TextField(max_length=50)
    photo = ImageWithThumbnailsField(upload_to='profiles',
                                     thumbnail={'size': (50, 50)})
</pre>
<p>A template (passed an instance of <tt class="docutils literal"><span class="pre">MyModel</span></tt>) would simply use something like:
<tt class="docutils literal"><span class="pre">&lt;img</span> <span class="pre">src=&quot;{{</span> <span class="pre">my_model.photo.thumbnail</span> <span class="pre">}}&quot;</span> <span class="pre">alt=&quot;{{</span> <span class="pre">my_model.name</span> <span class="pre">}}&quot;</span> <span class="pre">/&gt;</span></tt> or
even simpler for just a basic <tt class="docutils literal"><span class="pre">IMG</span></tt> tag:
<tt class="docutils literal"><span class="pre">{{</span> <span class="pre">my_model.photo.thumbnail_tag</span> <span class="pre">}}</span></tt>.</p>
<p>Note that when the source image is deleted, any related thumbnails are also
automatically deleted.</p>
<div class="section" id="multiple-thumbnails">
<h2>Multiple Thumbnails</h2>
<p>If you want to use multiple thumbnails for a single field, you can use the
<tt class="docutils literal"><span class="pre">extra_thumbnails</span></tt> argument, passing it a dictionary like so:</p>
<pre class="literal-block">
photo = ImageWithThumbnailsField(
    upload_to='profiles',
    thumbnail={'size': (50, 50)},
    extra_thumbnails={
        'icon': {'size': (16, 16), 'options': ['crop', 'upscale']},
        'large': {'size': (200, 400)},
    },
)
</pre>
<p>This would allow you to access the extra thumbnails like this:
<tt class="docutils literal"><span class="pre">my_model.photo.extra_thumbnails['icon']</span></tt> (or in a template,
<tt class="docutils literal"><span class="pre">{{</span> <span class="pre">my_model.photo.extra_thumbnails.icon</span> <span class="pre">}}</span></tt>).</p>
<p>You can use the simple template tags by using the <tt class="docutils literal"><span class="pre">extra_thumbnails_tag</span></tt>
property: <tt class="docutils literal"><span class="pre">my_model.photo.extra_thumbnails_tag['large']</span></tt>.</p>
</div>
<div class="section" id="changing-the-thumbnail-tag-html">
<h2>Changing the thumbnail tag HTML</h2>
<p>If you don't like the default HTML output by the thumbnail tag shortcuts
provided by this field, you can use the <tt class="docutils literal"><span class="pre">thumbnail_tag</span></tt> argument. For
example, to use HTML4.0 compliant tags, you would do the following:</p>
<pre class="literal-block">
photo = ImageWithThumbnailsField(
    upload_to='profiles',
    thumbnail={'size': (50, 50)},
    template_tag='&lt;img src=&quot;%(src)s&quot; width=&quot;%(width)s&quot; height=&quot;%(height)s&quot;&gt;'
)
</pre>
</div>
<div class="section" id="generate-a-different-image-type-than-jpeg">
<h2>Generate a different image type than JPEG</h2>
<p>PIL chooses which type of image to save as based on the extension so you can
use the <tt class="docutils literal"><span class="pre">extension</span></tt> argument to save as a different image type that the
default JPEG format. For example, to make the generated thumbnail a PNG file:</p>
<pre class="literal-block">
photo = ImageWithThumbnailsField(
    upload_to='profiles',
    thumbnail={'size': (50, 50), 'extension': 'png'}
)
</pre>
</div>
</div>
<div class="section" id="pdf-and-word-document-thumbnails">
<h1>PDF and Word document thumbnails</h1>
<p>PDF conversion is done with ImageMagick's <cite>convert</cite> program. The default
location where <tt class="docutils literal"><span class="pre">sorl.thumbnail</span></tt> will look for this program is
<cite>/usr/bin/convert</cite>.</p>
<p>Word documents are converted to a PostScript file with wvWare's <cite>wvps</cite> program.
The default location where <tt class="docutils literal"><span class="pre">sorl.thumbnail</span></tt> will look for this program is
<cite>/usr/bin/wvPS</cite>. This file is then converted to an image with ImageMagick's
<cite>convert</cite> program.</p>
<p>To specify an alternate location for either of these programs, add the relevant
property to your settings module:</p>
<pre class="literal-block">
THUMBNAIL_CONVERT = '/path/to/imagemagick/convert'
THUMBNAIL_WVPS = '/path/to/wvPS'
</pre>
</div>
<div class="section" id="thumbnail-filenames">
<h1>Thumbnail filenames</h1>
<p>The thumbnail filename is generated from the source filename, the target size,
any options provided and the quality.</p>
<p>For example, <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">thumbnail</span> <span class="pre">&quot;1.jpg&quot;</span> <span class="pre">80x80</span> <span class="pre">crop,bw</span> <span class="pre">%}</span></tt> will save the
thumbnail image as:</p>
<pre class="literal-block">
MEDIA_ROOT + '1_jpg_80x80_crop_bw_q85.jpg'
</pre>
<p>By default, thumbnails are saved in the same directory as the source image.
You can override this behaviour by adding one or more of the following
properties to your settings module:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">THUMBNAIL_BASEDIR</span></tt></dt>
<dd>Save thumbnail images to a directory directly off <tt class="docutils literal"><span class="pre">MEDIA_ROOT</span></tt>,
still keeping the relative directory structure of the source image.</dd>
<dt><tt class="docutils literal"><span class="pre">THUMBNAIL_SUBDIR</span></tt></dt>
<dd>Save thumbnail images to a sub-directory relative to the source image.</dd>
<dt><tt class="docutils literal"><span class="pre">THUMBNAIL_PREFIX</span></tt></dt>
<dd>Prepend thumnail filenames with the specified prefix.</dd>
</dl>
<p>For example, if the tag was <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">thumbnail</span> <span class="pre">&quot;photos/1.jpg&quot;</span> <span class="pre">150x150</span> <span class="pre">%}</span></tt> then
<tt class="docutils literal"><span class="pre">THUMBNAIL_BASEDIR</span> <span class="pre">=</span> <span class="pre">'thumbs'</span></tt> would save the thumbnail as:</p>
<pre class="literal-block">
MEDIA_ROOT + '/thumbs/photos/1_jpg_150x150_q85.jpg'
</pre>
<p>or <tt class="docutils literal"><span class="pre">THUMBNAIL_SUBDIR</span> <span class="pre">=</span> <span class="pre">'_thumbs'</span></tt> would save the thumbnail as:</p>
<pre class="literal-block">
MEDIA_ROOT + '/photos/_thumbs/1_jpg_150x150_q85.jpg'
</pre>
<p>or <tt class="docutils literal"><span class="pre">THUMBNAIL_PREFIX</span> <span class="pre">=</span> <span class="pre">'__'</span></tt> would save the thumbnail as:</p>
<pre class="literal-block">
MEDIA_ROOT + '/photos/__1_jpg_150x150_q85.jpg'
</pre>
</div>
<div class="section" id="changing-the-default-jpeg-quality">
<h1>Changing the default JPEG quality</h1>
<p>If you would rather your thumbnail images have a different default JPEG
quality than 85, add a <tt class="docutils literal"><span class="pre">THUMBNAIL_QUALITY</span></tt> property to your settings module.
For example:</p>
<pre class="literal-block">
THUMBNAIL_QUALITY = 95
</pre>
<p>This will only affect images which have not be explicitly given a quality
option.</p>
</div>
<div class="section" id="change-the-default-thumbnail-image-file-type">
<h1>Change the default thumbnail image file type</h1>
<p>By default, generated thumbnails are saved as JPEG files (with the extension
<tt class="docutils literal"><span class="pre">.jpg</span></tt>).</p>
<p>PIL chooses which type of image to save as based on the extension so you can
change the default image file type by adding a <tt class="docutils literal"><span class="pre">THUMBNAIL_EXTENSION</span></tt> property
to your settings module. For example:</p>
<pre class="literal-block">
THUMBNAIL_EXTENSION = 'png'
</pre>
<p>Obviously, if you change the extension, the <tt class="docutils literal"><span class="pre">THUMBNAIL_QUALITY</span></tt> JPEG setting
will have no effect.</p>
</div>
<div class="section" id="filesize-filter">
<h1><tt class="docutils literal"><span class="pre">filesize</span></tt> filter</h1>
<p>This filter returns the number of bytes in either the nearest unit or a specific
unit (depending on the chosen format method).</p>
<p>Use this filter to output user-friendly file sizes. For example:</p>
<pre class="literal-block">
{% thumbnail source 200x200 as thumb %}
Thumbnail file size: {{ thumb.filesize|filesize }}
</pre>
<p>If the generated thumbnail size came to 2000 bytes, this would output
&quot;Thumbnail file size: 1.9 KiB&quot; (the filter's default format is <tt class="docutils literal"><span class="pre">auto1024</span></tt>).
You can specify a different format like so:</p>
<blockquote>
{{ thumb.filesize|filesize:&quot;auto1000long&quot; }}</blockquote>
<p>Which would output &quot;2 kilobytes&quot;.</p>
<p>Acceptable formats are:</p>
<dl class="docutils">
<dt>auto1024, auto1000</dt>
<dd>convert to the nearest unit, appending the abbreviated unit name to the string
(e.g. '2 KiB' or '2 kB').
auto1024 is the default format.</dd>
<dt>auto1024long, auto1000long</dt>
<dd>convert to the nearest multiple of 1024 or 1000, appending the correctly
pluralized unit name to the string (e.g. '2 kibibytes' or '2 kilobytes').</dd>
<dt>kB, MB, GB, TB, PB, EB, ZB or YB</dt>
<dd>convert to the exact unit (using multiples of 1000).</dd>
<dt>KiB, MiB, GiB, TiB, PiB, EiB, ZiB or YiB</dt>
<dd>convert to the exact unit (using multiples of 1024).</dd>
</dl>
<p>The auto1024 and auto1000 formats return a string, appending the correct unit to
the value. All other formats return the floating point value.</p>
</div>
<div class="section" id="thumbnail-processors">
<h1>Thumbnail Processors</h1>
<p>By specifying a list of <tt class="docutils literal"><span class="pre">THUMBNAIL_PROCESSORS</span></tt> in your settings module, you
can change (or add to) the processors which are run when you create a
thumbnail. Note that the order of the processors is the order in which they
are called to process the image.</p>
<p>For example, to add your own processor to the list of possible, you would
create a processor like this:</p>
<pre class="literal-block">
def your_processor(image, requested_size, opts):
    if 'your_option' in opts:
        process_image(image)
your_processor.valid_options = ['your_option']
</pre>
<p>And add the following to your settings module:</p>
<pre class="literal-block">
THUMBNAIL_PROCESSORS = (
    # Default processors
    'sorl.thumbnail.processors.colorspace',
    'sorl.thumbnail.processors.autocrop',
    'sorl.thumbnail.processors.scale_and_crop',
    'sorl.thumbnail.processors.filters',
    # Custom processors
    'your_project.thumbnail_processors.your_processor',
)
</pre>
<div class="section" id="default-processors">
<h2>Default processors</h2>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">colorspace</span></tt></dt>
<dd>This processor is best kept at the top of the list since it will convert
the image to RGB color space needed by most of following processors. It is
also responsible for converting an image to grayscale if <tt class="docutils literal"><span class="pre">bw</span></tt> option is
specified.</dd>
<dt><tt class="docutils literal"><span class="pre">autocrop</span></tt></dt>
<dd>This will crop the image of white edges and is still pretty experimental.</dd>
<dt><tt class="docutils literal"><span class="pre">scale_and_crop</span></tt></dt>
<dd>This will correctly scale and crop your image as indicated.</dd>
<dt><tt class="docutils literal"><span class="pre">filters</span></tt></dt>
<dd>This provides the <tt class="docutils literal"><span class="pre">sharpen</span></tt> and <tt class="docutils literal"><span class="pre">detail</span></tt> options described in the
options section</dd>
</dl>
</div>
<div class="section" id="writing-a-custom-processor">
<h2>Writing a custom processor</h2>
<p>A custom processor takes exactly three arguments: The image as a PIL Image
Instance, the requested size as a tuple (width, hight), options as strings
in a list. Your custom processor should return the processed PIL Image instance.
To make sure we provide our tag with valid options and to make those available
to your custom processors you have to attach a list of valid options. This is
simply done by attaching a list called valid_options to your processor as
described in the above example.</p>
</div>
</div>
<div class="section" id="id1">
<h1>Advanced usage</h1>
<p>Some helpful methods are provided in the <tt class="docutils literal"><span class="pre">sorl.thumbnail.utils</span></tt> module which
can find (and delete) any thumbnails matching a source file name or all
thumbnail files.</p>
<p>Use the <tt class="docutils literal"><span class="pre">DjangoThumbnail</span></tt> class in <tt class="docutils literal"><span class="pre">sorl.thumbnail.main</span></tt> if you want
behaviour similar to the <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">thumbnail</span> <span class="pre">%}</span></tt> tag (i.e. using the <tt class="docutils literal"><span class="pre">MEDIA_ROOT</span></tt>
and <tt class="docutils literal"><span class="pre">MEDIA_URL</span></tt>) in your Python code. If you want to use a different file
naming method, just subclass and override the <tt class="docutils literal"><span class="pre">_get_relative_thumbnail</span></tt>
method.</p>
<p>Use the <tt class="docutils literal"><span class="pre">Thumbnail</span></tt> class in <tt class="docutils literal"><span class="pre">sorl.thumbnail.base</span></tt> for more low-level
creation of thumbnails. This class doesn't have any Django-specific ties.</p>
<div class="section" id="clean-up-script-bin-thumbnail-cleanup-py">
<h2>Clean-up script <tt class="docutils literal"><span class="pre">bin/thumbnail_cleanup.py</span></tt></h2>
<p>This script is used to delete thumbnails that no longer have an original file.</p>
<div class="section" id="how-it-works">
<h3>How it works</h3>
<ol class="arabic simple">
<li>It will look through all your models and find ImageFields, then from the
upload_to argument to that it will find all thumbnails.</li>
<li>If then in turn the thumbnail exists but not the original file, it will
delete the thumbnail.</li>
</ol>
</div>
<div class="section" id="limitations">
<h3>Limitations</h3>
<ul class="simple">
<li>It will not even try to delete thumbnails in date formatted directories.</li>
<li>There can occur name collisions if a file name matches that of a potential
thumbnail (THUMB_RE).</li>
</ul>
</div>
</div>
</div>
</div>
</body>
</html>
