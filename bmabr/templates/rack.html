{% extends "base.html" %} 
{% load thumbnail %}

{% block title %} fixcity - overview page  {% endblock %} 

{% block header %} 

<script src="/site_media/openlayers/OpenLayers.js"></script>
<script defer="defer" type="text/javascript">
    var map, layer, select;
    var options = {
            projection: new OpenLayers.Projection("EPSG:900913"),
	    displayProjection: new OpenLayers.Projection("EPSG:4326"),
	    units: "m",
	    numZoomLevels:19,
            maxResolution: 156543.03390625,
	    maxExtent: new OpenLayers.Bounds(-20037508.34, -20037508.34,
					     20037508.34, 20037508.34)
	   };

        function loadMap(){
	map = new OpenLayers.Map('overview-map',options);

	var osm = new OpenLayers.Layer.WMS(
                 "OpenStreetMap",
                 "http://maps.opengeo.org/geowebcache/service/wms",   
       {
            layers: "openstreetmap", 
            format: "image/png",
            bgcolor: '#A1BDC4'
            }, 
            {wrapDateLine: true} 
        );

    {% for rack in rack_query %} 
        var rack = new OpenLayers.Layer.Vector("Racks", {
                    projection: map.displayProjection,
                    strategies: [
                        new OpenLayers.Strategy.Fixed(),
                    ],  

                    protocol: new OpenLayers.Protocol.HTTP({
                        url: "./rack/{{rack.id}}.kml",
                    params: {         
                        },
                        format: new OpenLayers.Format.KML()
                    }),
                });
   var bounds = new OpenLayers.Bounds{{rack.location.extent}} ; 
   bounds.transform(map.displayProjection, map.projection); 
{% endfor %} 


    map.addLayers([osm,rack]);
    var center = new OpenLayers.LonLat(-73.94,40.63);  
    center.transform(map.displayProjection, map.projection);
    map.zoomToExtent(bounds);
}

</script>    

<script defer="defer" type="text/javascript"> 
  window.onload = function() { 
    loadMap() ; 
   }
</script> 


{% endblock %}

{% block menu %} 
<ul id="menu">
  <li class="suggest">
    <a href="/">(1) SUGGEST</a>
    <p> Suggest a bike rack location</p>
  </li>
  <li class="assess">
    <a href="/assess/">(2) ASSESS</a>
    <p> Assess current requested locations </p>
  </li>
  <li class="submit">
    <a href="/submit/">(3) SUBMIT</a>
    <p> Submit your request to the DOT </p>
  </li>
  <li class="built">
    <a href="/built/"> (4) BUILT</a>
    <p> See racks already built </p>
  </li>
</ul>

{% endblock %} 

{% block content %} 
{% for rack in rack_query %} 
<div class="assess">
  <div id="page-title">
    <h2 class="title">{{rack.address}}</h2>
  </div>
<div id="overview-top">
  <div id="map-con"> 
    <div id="overview-map"> </div>
  </div>
<div id="overview-assess" >
    <input type="checkbox" /> <span> Location Assessment finished?</span>
     <div class="overview-title">
       <span> <h3> Help </h3></span>
       <h2> Asesss</h2>
     </div> 
    <form>
        <textarea rows="4" cols="55"> </textarea>
        <input type="submit" value="Add your Comment" />
  </form>
  
  </div>
</div>

{% endfor %} 
</div>
{% endblock %} 



