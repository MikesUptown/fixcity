{% extends "base.kml" %}
{% block placemarks %}

{% for rack in page.object_list %}
  <Placemark>

    <atom:id>{{rack.id}}</atom:id>
    <name>{{rack.title}}</name>
    <address>{{rack.address}}</address>

    <description>{{rack.description|default:""}}</description>	
    <Snippet>{{rack.description|default:""|truncatewords:12}}</Snippet>	

    {% if rack.photo %}
     <!-- can't find anything suitable in the kml spec... 
          let's make some tag soup -->
     <topp:thumbnail>{{rack.photo.thumbnail}}</topp:thumbnail>
    {% endif %}


    {% autoescape off %}
    {{rack.location.kml}}    
    {% endautoescape %}	

    <!-- let's sneak pagination in here -->
    {% if forloop.first %}
      {% if page.has_previous %}
        <atom:link
          rel="previous"
          href="/verify/rack/requested.kml?page={{page.previous_page_number}}&amp;pagesize={{pagesize}}" />
      {% endif %}
    {% endif %}

    {% if forloop.last %}
      {% if page.has_next %}
        <atom:link
          rel="next"
          href="/verify/rack/requested.kml?page={{page.next_page_number}}&amp;pagesize={{pagesize}}" />
      {% endif %}
    {% endif %}

  </Placemark>
{% endfor %}{% endblock %}

